var app=angular.module("todoApp_TOROLNI",[],function($interpolateProvider){$interpolateProvider.startSymbol("<%"),$interpolateProvider.endSymbol("%>")});app.controller("TodoListController",function(){var todoList=this;todoList.todos=[{text:"learn AngularJS",done:!0},{text:"build an AngularJS app",done:!1}],todoList.addTodo=function(){todoList.todos.push({text:todoList.todoText,done:!1}),todoList.todoText=""},todoList.remaining=function(){var count=0;return angular.forEach(todoList.todos,function(todo){count+=todo.done?0:1}),count},todoList.archive=function(){var oldTodos=todoList.todos;todoList.todos=[],angular.forEach(oldTodos,function(todo){todo.done||todoList.todos.push(todo)})}}),app.controller("Hello",function($scope,$http){var data=$.param({api_key:"57f694132e4714c29a64c9af890b124e",tags:"animals"}),config={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}};$http.post("https://api.flickr.com/services/rest/?method=flickr.photos.search",data,config).then(function(response){},function(response){})});var app=angular.module("FlickrApp",["ngMaterial"],function($interpolateProvider,$httpProvider){$interpolateProvider.startSymbol("<%"),$interpolateProvider.endSymbol("%>"),$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8;"});app.constant("API_KEY","57f694132e4714c29a64c9af890b124e"),app.factory("ImageListService",function($http,$httpParamSerializer,API_KEY){var getData=function(){var json_data={api_key:API_KEY,format:"json",nojsoncallback:"1"},data=$.param(json_data)+"&"+$httpParamSerializer(this.search_arguments);return $http.post("https://api.flickr.com/services/rest/?method=flickr.photos.search",data)},setSearchArguments=function(search_arguments){this.search_arguments=search_arguments};return{getData:getData,setSearchArguments:setSearchArguments}}),app.factory("ImageInfoService",function($http,API_KEY){var getData=function(photo_id){var data=$.param({api_key:API_KEY,format:"json",nojsoncallback:"1",photo_id:photo_id});return $http.post("https://api.flickr.com/services/rest/?method=flickr.photos.getInfo",data)};return{getData:getData}}),app.directive("flickrImages",function(){return{templateUrl:"html_template/flickr/image_list.html"}}),app.directive("listItems",function(){return{restrict:"EA",scope:{source:"="},template:'<ul><li ng-repeat="item in data" value="{{item.id}}">{{item.name}} <list-items data="item.items" ng-if="item.items"></list-items> </li></ul>'}}),app.controller("FlickrContentCtrl",function(ImageListService,ImageInfoService,$scope,$mdDialog){var ctrl=this;ctrl.content=[],$scope.search_arguments=[],$scope.search_arguments.tags=[],$scope.keywords=[{title:"Animals",level1:[{title:"Pets",level2:["Guppy","Parrot"]},{title:"Wild animals",level2:["Tiger","Ant"]}]}],ctrl.fetchContent=function(){ImageListService.getData().then(function(result){"fail"!=result.data.stat&&(ctrl.content=result.data.photos.photo)})},$scope.appendSearchArgumentsTag=function(item){$scope.search_arguments.tags.push(item)},$scope.removeSearchArgumentsTag=function(index){$scope.search_arguments.tags.splice(index,1)},$scope.searchImage=function(){ImageListService.setSearchArguments($scope.search_arguments),ctrl.fetchContent()},$scope.showAlert=function(event,photo_id){function DialogCtrl($scope,$mdDialog,result,ImageInfoService){$scope.photo_info=result.data.photo,$scope.answer=function(answer){$mdDialog.hide(answer)}}ImageInfoService.getData(photo_id).then(function(result){$mdDialog.show({templateUrl:"html_template/flickr/dialog_info_content.html",locals:{result:result},parent:angular.element(document.body),controller:DialogCtrl,targetEvent:event})})},ctrl.fetchContent()});var app=angular.module("MyFlickrApp",["ngMaterial"],function($interpolateProvider,$httpProvider){$interpolateProvider.startSymbol("<%"),$interpolateProvider.endSymbol("%>"),$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8;"});app.config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push("myHttpResponseInterceptor")}]),app.factory("myHttpResponseInterceptor",["$q","$location",function($q,$location){return function(promise){return promise.then(success,error)}}]),app.controller("MyFlickerController",function($http,$scope,$mdDialog,ImageInfoService){$scope.showEdit=function(event,photo_id){function DialogCtrl($scope,$mdDialog,result,$window){$scope.photo_info=result.data.photo,$scope.setImageInfo=function(){ImageInfoService.setImageInfo($scope.photo_info).then(function(result){result.data.need_redirect&&($window.location.href=result.data.url),result.data.ok&&$mdDialog.show($mdDialog.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).textContent("Seved").ok("Got it!").targetEvent(ev))})},$scope.answer=function(answer){$mdDialog.hide(answer)}}ImageInfoService.getData(photo_id).then(function(result){$mdDialog.show({templateUrl:"html_template/flickr/dialog_edit_content.html",locals:{result:result},fullscreen:$scope.customFullscreen,parent:angular.element(document.body),controller:DialogCtrl,targetEvent:event})})}}),app.factory("ImageInfoService",function($http){var getData=function(photo_id){var data=$.param({photo_id:photo_id});return $http.post("/show_flicker_image_info",data)},setImageInfo=function(photo_info){var data=$.param({photo_info:photo_info});return $http.post("/set_flicker_image_info",data)};return{getData:getData,setImageInfo:setImageInfo}});